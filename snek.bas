' Snek (C) 2025 by Sacred Potato
' Productions is licensed under
' GNU General Public License v3.0 
' To view a copy of this license, visit
' https://www.gnu.org/licenses/gpl-3.0.en.html

Data 349,175,0,0,0,0,523,262,554,277,0,0,0,0
Data 466,233,0,0,0,0,466,233,523,262,0,0,330,131,0,0
Data 349,175,0,0,0,0,523,262,554,277,523,262,0,0,466,233
Data 0,0,523,262,554,277,466,233,523,262,392,196,165,330,392,196
Data 349,175,0,0,0,0,523,262,554,277,523,262,0,0,466,233
Data 0,0,523,262,554,277,466,233,523,262,523,330,523,349,523,330
Data 349,175,0,0,0,0,523,262,554,277,466,0,262,0,466,233,0,233,0,233
Data 466,233,523,262,554,0,330,233,523,262
Data 698,0,0,175,0,175,622,0,554,0,0,175,0,175,523,0,466,0
Data 0,233,466,0,523,233,554,0,523,196,0,196,233,392
Data 999,999

DefineFont #8
  29201010 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 800A0007 80088030 1C059038 0A090A09 12110A09 0C90FA71 0680F28F
  380FDC70 001C0000 003E003E 0064009C 0064009C 0004001C 00060004 80040005
  800C4004 38000000 7C007C00 26003900 26003900 20003800 60002000 2001A000
  30012002 A0005000 5E01AC00 FEFF5E81 00100C08 004000A0 00000000 00000000
  00000000 00000000 00000000 00000000 05000200 10300800 817AFF7F 0035807A
  000A0005 00000000 00000000 00000000 00A00040 0C080010 5E81FEFF AC005E01
  5000A000 0005000A 807A0035 FF7F817A 08001030 02000500 00000000 00000000
  00000000 A0005000 5E01AC00 FEFF5E81 00100C08 004000A0 00000000 00000000
  00000000 003E0000 1080F0C3 10801080 08880888 04840488 04820482 04200440
  800FF810 C0070000 1080207C 04840880 04980484 04400480 84210440 04200420
  F0010C3F 00000000 50003000 84168808 04108411 04200420 04E00420 04700440
  F001080E C0010000 0810300E 04420420 E2800241 22801280 0220C247 FE080410
  00000007 00000000 FEC3007E 84280260 10202822 20102025 400C4011 00008003
  00000000 2020C01F 02411C26 C1812140 715C0182 05400940 8C088230 30081008
  0003C00C 187C0000 E627E4C3 C8410864 E8400840 C448042C 86516449 1F3C0140
  0000F003 703E8001 08470840 0C808880 C2815488 02420243 24540256 10441844
  003EF061 00000000 12000C00 42402200 128982BE 1248128A 24433220 0830C440
  E000181F 00000000 00100000 C020001F 10202020 50201044 10140820 20083008
  0000C007 0005000A 807A0035 FF7F817A 08001030 02000500 00000000 00000000
  00000000 00000000 00000000 00000000 00A00040 0C080010 5E81FEFF AC005E01
  5000A000 0F000300 7F003F00 FF00FF00 FF00FF00 FF00FF00 FF00FF00 3F007F00
  03000F00 00F000C0 00FE00FC 00FF00FF 00FF00FF 00FF00FF 00FF00FF 00FC00FE
  00C000F0 FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
  FFFFFFFF 00FF00FC FFFFFEFF 3FFFFFFF 0FFF1FFE FFFFFFFF FFFFFFFF FFFFFFFF
  00FFFFFF 00000000 00FE0000 FEFFF0FF F3FFF3FF FFFFFFFF FFFFFFFF F8FFFEFF
  000080FF 00000000 00000000 00000000 00000000 00F80007 00040008 00000002
  00000000 FF0FFF03 FF7FFF3F FFFFFF7F FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FF7FFFFF FF3FFF7F
  FF03FF0F F0FFC0FF FEFFFCFF FFFFFEFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FEFFFFFF FCFFFEFF
  C0FFF0FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FE7FFFFF FC3FFE7F
  C003F00F FE3FFE07 FF7FFF7F FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
  FFFFFFFF 008000C0 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 01000300 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 F00FC003 FE7FFC3F FFFFFE7F FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
  FFFFFFFF 00C00080 00F000E0 00FC00F8 00FF00FE C0FF80FF F0FFE0FF FCFFF8FF
  FFFFFEFF FEFFFFFF F8FFFCFF E0FFF0FF 80FFC0FF 00FE00FF 00F800FC 00E000F0
  008000C0 FF7FFFFF FF1FFF3F FF07FF0F FF01FF03 7F00FF00 1F003F00 07000F00
  01000300 03000100 0F000700 3F001F00 FF007F00 FF03FF01 FF0FFF07 FF3FFF1F
  FFFFFF7F 04400000 E82F06C0 9013F01F 600D9013 A00AE00F D017E00F 08200C60
  00000000
End DefineFont

DefineFont #9
  5F200808
  0403000001060404
  06F90000FF000000
  20C00000C0202020
  0000000000008000
  0000000000FF00FF
  0000000000000100
End DefineFont

Sub PlotMap
  If Map(x,y)=0 Then
    RockColor=RGB(black)
    RockChar=32
  Else
    If Map(x,y)<11 Then
     RockColor=RGB(gray)
     RockChar=Map(x,y)+40
    Else
      If Map(x,y)<21 Then
        RockColor=RGB(lightgray)
        RockChar=Map(x,y)+30
      Else
        If Map(x,y)<31 Then
          RockColor=RGB(brown)
          RockChar=Map(x,y)+20
        Else
          RockColor=RGB(beige)
          RockChar=Map(x,y)+10
        End If
      End If
    End If
  End If
  Text (x-1)*16,(y-1)*16,Chr$(RockChar),,8,,RockColor,RGB(black)
End Sub


Sub MovePlayer
  If PlayerX+PlayerXDir<>0 And PlayerX+PlayerXDir<>21 And PlayerY+PlayerYDir<>0 And PlayerY+PlayerYDir<>21 Then
    If Map(PlayerX+PlayerXDir,PlayerY+PlayerYDir)=0 Then
      PlayerX=PlayerX+PlayerXDir
      PlayerY=PlayerY+PlayerYDir
      Moves=Moves+1
    Else
      If Not (PlayerX+(PlayerXDir*2)=SnakeX And PlayerY+(PlayerYDir*2)=SnakeY) Then
        If Map(PlayerX+(PlayerXDir*2),PlayerY+(PlayerYDir*2))=0 Then
          Map(PlayerX+(PlayerXDir*2),PlayerY+(PlayerYDir*2))=Map(PlayerX+PlayerXDir,PlayerY+PlayerYDir)
          Map(PlayerX+PlayerXDir,PlayerY+PlayerYDir)=0
          x=PlayerX+(PlayerXDir*2)
          y=PlayerY+(PlayerYDir*2)
          PlotMap
          PlayerX=PlayerX+PlayerXDir
          PlayerY=PlayerY+PlayerYDir
        End If
      End If
    End If
  End If
End Sub


Sub Center
  LeftEdge=160-(16*(Len(msg$)/2))
End Sub


Sub CheckSnake
  BoxedIn=0
  If SnakeX=1 Or SnakeX=20 Then BoxedIn=1
  If SnakeY=1 Or SnakeY=20 Then BoxedIn=BoxedIn+1
  If Map(SnakeX-1,SnakeY)<>0 Then BoxedIn=BoxedIn+1
  If Map(SnakeX+1,SnakeY)<>0 Then BoxedIn=BoxedIn+1
  If Map(SnakeX,SnakeY-1)<>0 Then BoxedIn=BoxedIn+1
  If Map(SnakeX,SnakeY+1)<>0 Then BoxedIn=BoxedIn+1
End Sub


Sub PlayTheme
  Read a,b
  If a=999 Then Restore : Read a,b
  If a<>0 Or b<>0 Then
    Select Case channel
      Case -1
        Play tone a,b,300
      Case 1
        Play tone b,a,300
    End Select
    channel=-channel
  End If
  Pause 300
End Sub


Randomize Timer
Dim Map(21,21)
CLS
Font 8
channel=1
Color RGB(green),RGB(black)
Print " ;789"; : Color RGB(pink) : Print ":"
Color RGB(green)
Print " 7             C C"
Print " 7    ;77= ;76 7GE"
Print " <77= 7AB7 7   7E"
Print "    7 7  7 776 7D"
Print "    7 7  7 7   7FD"
Print "5777> ?  <77777> ?"
Text 0,150,"Watch out for heckin snek!!!!1!!one",,1,,RGB(white)
Text 48,190,"Push rocks to trap",,1,,RGB(white)
Text 48,206,"snek like this:",,1,,RGB(white)
Text 200,200,Chr$(41),,8,1,RGB(gray)
Text 184,216,Chr$(49),,8,1,RGB(beige)
Text 200,216,Chr$(33),,8,1,RGB(green)
Text 216,216,Chr$(47),,8,1,RGB(lightgray)
Text 200,232,Chr$(46),,8,1,RGB(brown)
Text 96,255,"BE CAREFUL. he bite.",,1,,RGB(yellow)
Text 30,272,"%$#",,9,2,RGB(yellow)
Text 30,288," !"+Chr$(34),,9,2,RGB(brown)
Text 78,288,"Sacred Potato Productions",,1,,RGB(white)
Text 80,304,"Some rights reserved.",,1,,RGB(white)
Do
  k$=Inkey$
  PlayTheme
Loop Until k$<>""




'Place rocks
Do
For x=1 To 20
  For y=1 To 20
    If Not (x=1 And y=10) Then
      If Rnd>.7 Then Map(x,y)=Int(Rnd*40)+1 Else Map(x,y)=0
    End If
  Next y
Next x
SetupTone=500
oldSetupTone=490

'Place snake
SpotChosen=0
Do
  SnakeX=Int(Rnd*20)+1
  SnakeY=Int(Rnd*20)+1
  If Map(SnakeX,SnakeY)=0 Then
    If Not (SnakeX=1 And SnakeY=10) Then
      CheckSnake
      If BoxedIn<>4 Then SpotChosen=1
    End If
  End If
Loop Until SpotChosen=1
PlayerX=1
PlayerY=10
ItsOver=0
Dead=0
OldPlayerOrientation=0
PlayerOrientation=35
Moves=0
SnakeMoves=0
InGame=0
SnakeOrientation=Int(Rnd*4)+1
CLS
For x=1 To 20
  For y=1 To 20
    PlotMap
  Next y
  Play tone setuptone,oldsetuptone,100
  OldSetupTone=SetpTone
  SetupTone=SetupTone+60
  Pause 2
Next x

Do Until i$=chr$27)
  If OldPlayerX<>PlayerX Or OldPlayerY<>PlayerY Or PlayerOrientation<>OldPlayerOrientation Then
    x=OldPlayerX
    y=OldPlayerY
    PlotMap
    Text (PlayerX-1)*16,(PlayerY-1)*16,Chr$(PlayerOrientation),,8,,RGB(magenta)
  End If
  If OldSnakeX<>SnakeX Or OldSnakeY<>SnakeY Then
    x=OldSnakeX
    y=OldSnakeY
    PlotMap
    Text (SnakeX-1)*16,(SnakeY-1)*16,Chr$(33),,8,,RGB(green)
  End If
  If SnakeX=PlayerX And SnakeY=PlayerY Then ItsOver=1
  If Dead=1 Then Dead=0:ItsOver=2
  If ItsOver=0 Then
    i$=Inkey$
    If i$<>"" Then InGame=1
    If InGame=0 Then
      PlayTheme
    Else
      Pause 100
      If i$<>"" Then
        OldPlayerX=PlayerX
        OldPlayerY=PlayerY
        OldPlayerOrientation=PlayerOrientation
        Select Case i$
          Case Chr$(27)
            quit=1
          Case Chr$(128),"W","w" 'Move up
            Select Case PlayerOrientation
              Case 34
                PlayerOrientation=36
              Case 35
                PlayerOrientation=51
              Case 37
                PlayerOrientation=51
              Case 52
                PlayerOrientation=36
            End Select
            PlayerXDir=0
            PlayerYDir=-1
            MovePlayer
          Case Chr$(129),"S","s" 'Move Down
            Select Case PlayerOrientation
              Case 34
                PlayerOrientation=37
              Case 35
                PlayerOrientation=52
              Case 36
                PlayerOrientation=52
              Case 51
                PlayerOrientation=37
            End Select
            PlayerXDir=0
            PlayerYDir=1
            MovePlayer
          Case Chr$(130),"A","a" 'Move Left
            PlayerOrientation=34
            PlayerXDir=-1
            PlayerYDir=0
            MovePlayer
          Case Chr$(131),"D","d" 'Move Right
            PlayerOrientation=35
            PlayerXDir=1
            PlayerYDir=0
            MovePlayer
        End Select
      End If
    End If
'  Move Snake
    OldSnakeX=SnakeX
    OldSnakeY=SnakeY
    CheckSnake
    If BoxedIn=4 Then
      Dead=1
    Else
      Do
        If GoodOrientation=0 Or Rnd>.3 Then SnakeOrientation=Int(Rnd*4)+1
        Select Case SnakeOrientation
          Case 1
            If SnakeX<>20 Then SnakeX=SnakeX+1
          Case 2
            If SnakeX<>1 Then SnakeX=SnakeX-1
          Case 3
            If SnakeY<>20 Then SnakeY=SnakeY+1
          Case 4
            If SnakeY<>1 Then SnakeY=SnakeY-1
        End Select

        If SnakeX=0 Then SnakeX=1
        If SnakeY=0 Then SnakeY=1
        If SnakeX=21 Then SnakeX=20
        If SnakeY=21 Then SnakeY=20
        If Map(SnakeX,SnakeY)<>0 Then
          SnakeX=OldSnakeX
          SnakeY=OldSnakeY
          GoodOrientation=0
        Else
          GoodOrientation=1
          SnakeMoves=SnakeMoves+1
        End If
      Loop Until GoodOrientation=1
    End If
  End If
Loop Until i$=Chr$(27) Or ItsOver<>0

Select Case ItsOver
  Case 1
    Text (PlayerX-1)*16,(PlayerY-1)*16,Chr$(72),,8,,RGB(white)
    Msg$="you iz ded."
    Center
    Text LeftEdge,100,msg$,,1,2,RGB(black),RGB(white)
    msg$="snek winz! & it only"
    center
    Text LeftEdge,124,Msg$,,1,2,RGB(black),RGB(white)
    Msg$="took "+Str$(SnakeMoves)+" moves"
    Center
    Text LeftEdge,148,Msg$,,1,2,RGB(black),RGB(White)
  Case 2
    msg$="snek iz trap"
    Select Case Int(Rnd*10)+1
      Case 1,2,3
        Msg$=Msg$+"!"
      Case 4
        Msg$=Msg$+"!!1!"
      Case Else
        Msg$=Msg$+"."
    End Select
    Center
    Text LeftEdge,100,msg$,,1,2,RGB(black),RGB(white)
    msg$="in "+Str$(Moves)+" moves."
    center
    Text LeftEdge,124,Msg$,,1,2,RGB(black),RGB(white)
    Msg$="heckin good job."
    Center
    Text LeftEdge,148,Msg$,,1,2,RGB(black),RGB(white)
  Case Else
    Msg$="u give up."
    Center
    Text LeftEdge,100,Msg$,,1,2,RGB(black),RGB(white)
End Select
Msg$="Play again? (y/n)"
Center
Text LeftEdge,250,Msg$,,1,2,RGB(black),RGB(white)
Restore
Do
  k$=Inkey$
  If k$=Chr$(27) Or k$="N" Or k$="n" Then CLS : End
  PlayTheme
Loop Until k$="Y" Or k$="y"
Loop
