' PicoMaze (C) 2026 by Sacred Potato
' Productions is licensed under
' CC BY-NC-SA 4.0. To view a copy of
' this license, visit
' https://creativecommons.org/licenses/by-nc-sa/4.0/

DefineFont #9
  5F200808
  0403000001060404
  06F90000FF000000
  20C00000C0202020
  0000000000008000
  0000000000FF00FF
  0000000000000100
End DefineFont

DefineFont #10
  1B200C08 FFFF7E00 E7FF18E7 00FFFFFF 00000000 91957F00 00000060 F3FF6600
  76FBFDFD 0000183C 99423C00 A2A9A5A5 003E419C 39827C00 A5A59545 003C4299
  C3FF0000 A59999A5 0000FFC3 C3810000 002400E7 00245A81 763C0000 DBDBF1FB
  00003C66 2A490000 2A146314 00000049 55AA55AA 55AA55AA 55AA55AA FFFFFFFF
  FFFFFFFF FFFFFFFF BB44EE11 BB44EE11 BB44EE11 FF020202 FF404040 FF101010
  7E7E3C00 7E7E7E7E 007E7E7E 3C000000 5299C37E 0000003C A6A79860 2C27E68C
  3C5E6E2C ABA0A060 3E2A4F5B 2A577F63 E546FC00 E949EF45 FF6F494F FF3C2418
  FF81B581 99A5E742 1C040800 91DB8D4A 187C9A99 D47C2800 64447CC4 FFF5A57E
  5A7E3C00 427E7E5A 003C6642 10000000 307E7E30 00000010 08000000 0C7E7E0C
  00000008 00000000 7E3C1800 00181818 18181800 00183C7E 00000000 00000000
  00000000 00000000
End DefineFont

DefineFont #11
  24202020 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00028000 00054001 80082002 40101004 20200808 104FE411 88D01722 487C7D24
  48E28F24 48C28724 48228824 48129024 48129024 48129024 90200812 10000010
  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 00000000 00000000 00000000 00000000 00000000 00028000 00054001
  80082002 40101004 20200808 104FE411 88F01F22 48FC7F24 48A28B24 48228924
  48E28F24 48D29724 48129024 48129024 48129024 48228824 88244822 10092021
  20028010 40000008 80000004 00000000 00000000 00000000 00000000 00000000
  00000000 0000001C 0000007F 000000FC 000000F8 000000FF 0000F0FF 0000FFFF
  00E0FF3F 00F0FF07 00F8FF10 00FEFF33 80EFBF7F C0F31F3F E0F80F60 78FE0F00
  30FE0F00 28FE0F00 00FE0F00 00FF0F00 00FF0F00 80FF0700 E0FF0700 D0FF0700
  E0FB3F00 F8F1FF0E FCF8FF1F FCFFF907 EC7F000F FE008017 3E008002 03000002
  00000000 00000000 00000000 00000000 0000003E 00008041 00004080 00002040
  0000D021 00002822 00002914 008C2518 00FC4508 00A88504 00780503 00880501
  00F01F01 00801F01 F0BFBF00 68E07F00 AC807F00 24817F00 14FAFE00 14046801
  94030800 54000000 34000000 0C000000 04000000 00000000 00000000 00000000
  00000000 00000000 0000001F 0000007F 0000FF77 0080FF7F 00C0FF7F 00C0FF67
  00E0FD13 00E0C613 00608103 20300101 60B00003 C0990000 C0FF0000 801B3F00
  00DB3F00 00367900 009CF300 0050F500 0020FE00 00706D00 00F87200 00F88900
  007E4601 003E2802 001E3002 001EF003 00FE3F02 00FE4F01 00FCAA00 00F86500
  00C01F00 8000F801 E018E00F F01CC03F 781E887F 78178C7D F8131EFB F808F2F3
  3804C2F7 3802C4F7 30018877 F000107F E000207E E000407C F000803C F03E003D
  707F0E3E F0E81F1E F0C4710F F8C3E80F ACFEC50F 46CBE703 C20CFF03 E00BFB07
  E09EEF3D 70F0F170 3080FFC1 3000E003 3000C003 20008007 6000C001 4000E000
  00006000 00000000 20000000 00020040 C0003000 00080420 80080808 00140400
  00010104 00500246 00100100 00048001 40240808 00002000 A0620000 00000400
  20208004 20040000 00000004 80081201 00000000 00010000 00082000 00400004
  40000000 00041801 40500000 00016400 00004200 00010000 00204800 00081C00
  00000200 00000000 00000000 00000000 00000000 00000000 00000C00 00003403
  0000E40D 8007A412 E03C882C F0E03132 D00FBF23 D0DE6D02 C0DAC503 C0DBC701
  C0DD6501 80FF2F01 80D43F01 801EFC01 801BFC01 80198C01 8019C401 8018C601
  8030C600 80314600 80014200 00002200 00006200 00007200 00000600 00000600
  00000200 00000000 00000000 00000000 00801F00 00E0FB03 0070FE07 00E0CB05
  00F89805 003C9007 00051007 0037A30B 00FFA10E 00FCF107 00BBB007 00991003
  00FF1B07 007F0A07 00390E07 003B0606 001B070E 800B0702 80010700 80010600
  C0810700 C0430700 C0020300 00000000 00000000 00000000 00000000 00000000
  00000000 00001000 00001800 00000C00 00000600 0000E601 0000B303 0080F302
  00802103 00C0BF01 00C0ED00 00E0C401 00D02603 00307A03 00100F01 00F88100
  0098FF00 00801200 00801700 00801000 00801E00 00C00F00 00C00E00 00E00C00
  00E00E00 00600E00 00300A00 00380E00 003C1E00 00141200 00161600 00123600
  001F3E00 00700000 00F00000 00F80100 00B00100 00E80100 00F80100 00F80000
  00A80000 00780700 00181D00 00187100 00F8C700 00A88200 00E8C700 004C4500
  00C64700 00026100 00021200 80010200 00000200 00E01F00 00201300 00303000
  00102000 00102000 00102000 00106000 00304000 00608000 0040C000 00E0E000
  00700000 00000000 00000300 00C0E700 806FF403 C03EFC03 80224B03 803F4803
  00DCF800 001E3E00 00FE3800 001E3800 002E1F00 00341800 00F43C00 006E7400
  005FF701 805DF607 E0BFFA0F F0A37B1E F03FF81C 30FFFD38 90FFFF39 80CFFC21
  800FF831 8007F839 8007F80D 8007F000 C007F000 C007E001 E00FF001 F80FF803
  00008003 00003C00 00004A00 00004500 00004500 00004500 00006300 00002300
  00007100 00008100 00008100 00808101 00C00001 00600003 00300006 00183004
  00083004 000C200C 00066008 0063F01C 8039902F 781E1054 EC191054 00EC3112
  00BA2108 008F3000 80831200 80801B00 40800D00 00800400 00800600 00000200
  00000000 00000C00 00C03700 00706000 0010C000 00188000 00088000 00088200
  00088200 0008C200 00083C00 00080800 0008103C F80C2067 0407C040 04034060
  0C014030 9001C018 E000800C 80008004 C0008007 40008002 40007806 40000604
  40000104 40800006 40800002 40806003 C000D300 80004C00 80014000 00016000
  00FF3F00 00000000 00000000 00000000 00000000 00000000 00000000 00800200
  00000500 00000F00 00000F00 00000F00 00000F00 00000100 00C03F00 00C04C00
  00401800 00C00300 00C00E00 00400800 00600400 00300600 00000200 00000000
  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 40000000 C0C3E101 C0EE7F00 80BD2D00 00ED3700 001B1A00 003E0F00
  00C00200 00C00000 009E0700 00060810 8051081C 80B81D0E C00C3E07 600E7A01
  304BF201 9008E200 70080100 30F80100 38EE0100 38FB0300 20F10600 80F80800
  80CC1800 C0861100 40033700 C0011E00 C0010E00 80010300 80830100 C0830700
  C0000000 00F00100 00F00300 00B00200 00380300 00700100 00C80100 00F00700
  001C3C00 000E6C00 000B4C00 00094E00 0009DA00 00099300 800DB100 8004A100
  8002A200 C03AE300 40FBC101 E0958301 F8348303 6434C307 405C430C 004C430C
  004A0300 008A0200 00870200 80C70200 80430300 C0C30300 40000300 C0000600
  80030600 00802000 00404000 00208000 00208000 3C20C030 E2C07778 A1C1284C
  23867443 458CE141 8938FB40 91E03EC0 11203086 A37DE09C C276C0B1 422B40BA
  226FC0A7 32CC40A7 169C61A6 1CF421A4 0C04316C 0CC47866 040C4862 043CC620
  04F4BB30 0432B001 00223001 00463001 0044B000 0044B000 004C9800 0068F800
  00380000 00C00700 00E00F00 00600C00 00200800 00E00E00 00200900 00400400
  00800300 00000100 00F83E00 00FC7E00 00FC7E00 00EC6E00 00EC6E00 00EC6E00
  006C6C00 006C6C00 006C6C00 00682C00 00EC6E00 002C6800 00E40F00 00EE0F00
  00EE0E00 00EE0E00 00EE0E00 00EE0E00 00EE0E00 00EE0E00 00E00E00 00400400
  00F01E00 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 00301F00 00560F00 009A0F00 00220F00 00220100 00C43F00 00D84C00
  00601800 00C00300 00C00E00 00400800 00600400 00300600 00000200 00000000
  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
  00000000 800FF001 80380C06 40E00704 40C00004 40000804 40021604 800C0104
  80000004 00810104 04430204 00C60404 009C0704 00300002 00C00042 00844102
  00003902 90000702 00000212 00208202 00007A02 00000603 00000201 00022241
  00009F01 08008100 0090C108 00A86001 00C43002 00641C02 00282702 00A82101
  00F0F801 00000000 00000000 00000000 00000000 00801F00 00801F00 00801400
  00800800 00800800 00904800 00202700 00402D00 00E01D00 00F03D00 00D06D00
  00D0CD00 00D0CD00 00D0CD00 00E0CD00 00C08D00 00C00D00 00E01D00 00F01D00
  00F01D00 00F83D00 00FC7A00 00000000 00000000 00000000 00000000 00000000
  00000000 00000000 00000000 00000000 00000000 00802000 00404000 00404E00
  00405F00 00802B00 00001F3C 00003F26 00781F22 00FC0F23 00FE0719 00EF070D
  80EF1F05 80EF7F03 80F7FF03 80F7FB01 80F78300 80F30300 80F90100 00DF0100
  00EF0100 00EF0100 00EF0100 00EF0100 00EF0300 00C60100 00000000 00000000
  00000000 00000000 00400000 00400300 0068E500 00C8B100 00749B00 001CCE00
  004E4300 00076000 00053800 000E0E00 000F0E00 00FE1F00 00597500 00F07F00
  000E0C00 00031800 80017000 8000D000 C008A001 400C2001 60FE2F01 6042F000
  40071C00 C0FD1F00 C0E42100 00EC2100 E0BB7100 1020DF01 10200101 E01FFF01
  00000000 00010001 00210801 00111001 00129000 00A28B00 10444408 28F83E14
  5440042A 94400529 2A818254 2A024154 29842394 254814A4 35B80AAC 652C19AC
  E52729A6 22A3CA47 22200948 22E00F48 243CF928 2423092B A420092C 64A00A38
  38A00A10 10A00A10 10A00A10 00A00E00 00A00600 00600400 00400400 00400E00
  00600400 00001C00 00001600 00811B00 80FB0800 C00F0800 400C0800 60080C00
  30180402 18100406 0C300404 7C60040C C8C7740F 0CB89F11 04F00020 045C0028
  C443FC41 7C400642 00400244 03600248 03200230 02200200 06B00300 0CF80F00
  983F3E00 F00F3300 00801100 00C01000 00601000 00603000 00C03000 00000000
  00000000 00000001 0000C001 0000B800 40008600 60004300 60803F00 A0C3E607
  206E1C0C C038F018 80718813 00010C12 00871713 00442811 0044CB11 00468B10
  0081FF10 80000018 4080070C 2040E807 205C2D00 20D62700 20136000 2011C000
  B0188F00 50C89800 3064A000 1834C000 0C14C000 000CC000 0008C000 0000C000
  00000000 00000000 00000000 00000000 00000000 00004800 00104800 00224800
  40446800 80889C01 00911701 00F29C02 009F2902 E001DB04 F0001209 9887370A
  88796C1C 08674818 08828900 08020A01 08040501 10840401 20888400 00884200
  00484200 00442200 00242100 00221100 00920800 00120800 00010000 00000000
  00000000 00004400 00088200 00188200 00106400 8030F800 8033F800 806FF800
  C07FE400 C0FF8200 C0FF0100 C0FF0100 E0FF0100 E01F1F00 F0072100 F8014F00
  38009300 0000A300 00002300 80C00300 C03F0600 80000C00 00000A00 00001100
  00801000 007F1000 00021000 00011000 00001000 00000800 00000C00 00001400
  00002400 00000000 00000000 00400000 0E600000 14301800 24302000 44283040
  44281850 84280C78 04290C24 6C2D0622 B8420E23 9C420B11 64C13811 04714821
  040D8420 84029C20 8400A620 84003510 04811808 C442000C 24010008 62E11F08
  C1102008 11082018 E1078011 2100C612 C1FF5912 0600A011 18004010 E0FF0008
  0000FF07 0000003F 00008040 000070C0 FC001C8F B8039393 D0CCF193 6832FD93
  2C19FF93 AC8CFF93 ACFEFF8F BCFE00C0 F8FE0060 10FEFF3F C8FFBF00 7C029800
  00FA9B00 00029A00 00929A00 00629A00 00529A00 00029A00 00FA9B00 0002B800
  00FFFF01 80FC7F02 80038003 80FFFF03 00FC7F00 80038003 80FFFF03 00FFFF01
  00FC7F00 00000000 00000000 0000E01F 00001020 0000C827 00002828 80072928
  40882A28 20132928 A014292C A0142922 20F72719 40141005 80F70F05 00140105
  00940305 00BE830F 00FE7F07 F0C3C30F 08024010 F4E3C72F FA1BD85F FAE7E75F
  FA07E05F FEFFFF7F AAAAAA4A ABAAAAEA ABAAAAEA BEAAAA7A F8AAAA1E 00555501
  00000000 00F0FF3F 00080024 00140022 00128021 00118071 80104002 40104002
  2010E007 10101008 1C38E007 EA571008 F7EFE007 FFFF1108 FFFFE107 0FE01108
  47C5E107 97D04102 07C18101 0FE38101 FFFF8101 57D58101 57D58101 57D58101
  57D58101 57D5E107 57D5F108 FFFFF10F FFFFF66F 0F60F99F FF7F0180 1FF00660
  FEFFF91F 00FE7F00 00018000 00018000 80FC3F01 80066001 80827F01 C0F27F03
  C0FA7F03 C0FA4F03 C0FA6F03 C0FE7F03 C0000003 FEFFFF7F 01000080 FD8FFFBF
  CD8CAAAA 358BFFBF CD8CAAAA FD8FFFBF 018004A9 D986FFBF 030000C0 FEFFFF3F
  10014004 E0008003 10014004 E0008003 40000001 B0008006 08014008 08022008
  10041004 00000000 00000000 00000000 00000000 00000000 00000000 00080000
  00060000 00010000 80190000 00070000 00010000 3C010000 42020000 C2040002
  C2080004 42080009 3C180011 08100032 70100014 40200008 40400008 40400008
  40400004 40400004 80808003 00834100 00FC7F00 00800100 00C00300 00C00300
  00E00700 00000000 30303000 48484800 F8FFFF0F 90848408 1003031F 10000028
  10000028 10000028 F0FFFF1F 10000008 10000008 10010008 9002F008 90FE4F09
  90024009 90030008 90020008 9002C00B 9002C00B 90028009 90828109 90128809
  90524A0A F89FF91F 94524A2A 9412282C 9482E12F 94029028 9402102A FEFFFF7F
  FEFFFF7F
End DefineFont


Sub ShowHelp
Box 4,112,312,150,1,RGB(red),RGB(black)
  Text 19,120,"6897",,10,,RGB(white),RGB(black)
  Text 72,120,"To move",,1,,RGB(white)
  Text 8,144,"[Space] Use ",,,,RGB(white)
  Color RGB(cyan)
  Font 10
  Print Chr$(40);
  Color RGB(white)
  Font 1
  Print " to remove a wall"
  Text 32,168,"E    Use "
  Font 10
  Color RGB(cobalt)
  Print ".";
  Font 1
  Color RGB(white)
  Print " to show traps & monsters"
  Text 32,192,"L    To locate player (and prize if"
  Text 72,204,"on level 30)"
  Text 26,228,"A key ("
  Font 10
  Color RGB(yellow)
  Print "!";
  Font 1
  Color RGB(white)
  Print ") will open any chest (";
  Font 10
  Color RGB(brown)
  Print " ";
  Font 1
  Color RGB(white)
  Print ")"
  Text 84,240,"on the same level."
  AnyKey
End Sub

Sub catchkeys
  For t=1 To 60
    i$=Inkey$
  Next
End Sub

Sub AnyKey
  Do
    i$=Inkey$
    PlayMusic
  Loop Until i$<>""
End Sub

Sub PlaceItem
  Do
    good=1
    x=Int(Rnd*xmax)+1
    y=Int(Rnd*ymax)+1
    If s(x,y)<>0 Then good=0
  Loop Until good=1
End Sub

Sub DrawItem
  Select Case s(t,j)
    Case 0,2,3
      Color RGB(black),RGB(black)
      char=58
    Case 1
      Color WallFc,WallBG
      char=WallChar
    Case 4
      Color RGB(magenta),RGB(black)
      char=35
    Case 5
      Color RGB(magenta),RGB(black)
      char=36
    Case 6
      Color RGB(gold),RGB(black)
      char=39
    Case 7
      If EyeOn=0 Then
        Color RGB(black),RGB(black)
        char=100
      Else
        Color RGB(red),RGB(black)
        char=38
      End If
    Case 8
      Color RGB(pink),RGB(black)
      char=34
    Case 9
      If EyeOn=0 Then
        Color RGB(black),RGB(black)
        char=100
      Else
        Color RGB(gray),RGB(lightgray)
        char=37
      End If
    Case 13
      Color RGB(gray),RGB(lightgray)
      char=37
    Case 10
      Color RGB(brown),RGB(black)
      char=32
    Case 11
      Color RGB(cyan),RGB(black)
      char=40
    Case 12
      Color RGB(yellow),RGB(black)
      char=33
    Case 14
      Color RGB(gray),RGB(black)
      char=45
    Case 15
      Color RGB(cobalt)
      char=46
    Case 16
      Color RGB(beige)
      char=47
    Case 17
      Color RGB(blue)
      char=48
    Case 18
      Color RGB(orange)
      char=49
    Case 19
      Color RGB(salmon)
      char=50
    Case 20
      Color RGB(gray)
      char=51
    Case 21
      Color RGB(gold)
      char=52
    Case Else
      Color RGB(red),RGB(black)
      char=38
  End Select
  Print Chr$(char);
End Sub

Sub TombStone
  CLS
  Circle 160,150,130,,,RGB(white)
  Box 30,150,261,180,,RGB(white)
  Box 31,149,259,180,,RGB(black),RGB(black)
  Circle 161,149,127,,,RGB(black),RGB(black)
  Text 124,95,"Here Lies",,1,,RGB(gray),RGB(black)
  Text 160-((Len(aname$)/2)*8),110,aname$,,1,,RGB(lightgray)
  Text 160-((Len(kline$)/2)*8),130,kline$,,,,RGB(lightgray)
  For t=1 To 5
    Text 160-((Len(epline$(t))/2)*8),150+12*t),epline$(t),,,,RGB(white),RGB(black)
  Next
End Sub

Sub DrawMap
  Text 0,12,""
  Font 10
  For t=1 To xmax
    For j=1 To ymax
      DrawItem
    Next
    Print
  Next
  If Maze<>30 Then
    Font 1
    Text (exity-1)*8,(exitx)*12,"EXIT->",,,,RGB(red),RGB(white)
  End If
Text 0,0,mtitle$,,1,,RGB(black),RGB(white)
End Sub

Sub MazeLine
  Text 0,((xmax+1)*12)+3,""
  Color RGB(white),RGB(black)
  Font 1
  Print "Level #";maze;"   ";
  Color RGB(pink)
  Font 10
  Print Chr$(34);
  Font 1
  Color RGB(white)
  Print hp;"  ";
  Font 10
  Color RGB(gold)
  Print Chr$(39);
  Font 1
  Color RGB(white)
  Print gp;
  Print String$(32,40-(12+Len(Str$(gp))+Len(Str$(hp))));
End Sub

Sub PlayMusic
  If PlayQueue$="" Then
    If GameOver=0 Then PlayQueue$=Music$(Int(Rnd*MusicCount)+1)
    If EndGame=1 Then PlayQueue$="587|175 X X 523|196 X X 466|233 X X 440|220 X X 466|233 X X 233|147 X X 294|175 X X 349|233 X X 466|294 X X X X X X X X X X X X X X ":EndGame=0:GameOver=1
  End If
  Do
    Pause PauseIncrement
    CurrentPause=CurrentPause+PauseIncrement
    If CurrentPause>=NoteLength Then
      If CurrentNote$<>"" And CurrentLength<NoteLength Then
        If freqx<>0 Then Play Tone FreqX,FreqY,NoteLength*2
        CurrentLength=CurrentLength+PauseLength
      Else
        CurrentNote$=""
        CurrentLength=0
        If PlayQueue$<>"" Then
          currentnote$=Left$(PlayQueue$,Instr(PlayQueue$," "))
          playqueue$=Mid$(PlayQueue$,Len(currentNote$)+1,Len(PlayQueue$))
          Select Case CurrentNote$
            Case "0 "
              FreqX=0
              FreqY=0
            Case "X ","- "
            Case Else
              freqx=Val(currentnote$)
              If Instr(CurrentNote$,"|")<>0 Then
                freqy=Val(Mid$(Currentnote$,Instr(CurrentNote$,"|")+1,Len(CurrentNote$)))
              Else
                FreqY=FreqX
          End Select
          If FreqX<>0 Or CurrentNote$="X " Then
            Play tone freqx,freqy,NoteLength*3
          Else
            If CurrentNote$="- " Then Play tone 0,0,NoteLength*3
          End If
        End If
      End If
    End If
  Loop Until CurrentPause>=PauseLength
  CurrentPause=0
  End If
  If zapon=1 And PlayQueue$="" Then playqueue$=ZapMusic$
End Sub

Sub NameGen
    Select Case Int(Rnd*12)+1
      Case 1
        pname$="Gary"
      Case 2
        pname$="Vernon"
      Case 3
        pname$="Walter"
      Case 4
        pname$="Harold"
      Case 5
        pname$="Bernie"
      Case 6
        pname$="Chuck"
      Case 7
        pname$="Norbert"
      Case 8
        pname$="Clarence"
      Case 9
        pname$="Gladys"
      Case 10
        pname$="Bernice"
      Case 11
        pname$="Myrtle"
      Case 12
        pname$="Hortense"
    End Select
    pname$=pname$+" the "
    Select Case Int(Rnd*10)+1
      Case 1
        pname$=pname$+"Almost"
      Case 2
        pname$=pname$+"Satisfactory"
      Case 3
        pname$=pname$+"Present"
      Case 4
        pname$=pname$+"Acceptable"
      Case 5
        pname$=pname$+"Adequate"
      Case 6
        pname$=pname$+"Passable"
      Case 7
        pname$=pname$+"Okay"
      Case 8
        pname$=pname$+"Tolerable"
      Case 9
        pname$=pname$+"Inoffensive"
      Case 10
        pname$=pname$+"Bland"
  End Select
End Sub

Sub ShowTitle
  For t=1 To Len(title$)
    ch$=Mid$(title$,t,1)
    If ch$="$" Then
      ch$=Chr$(219)
      Color wc,wc
    Else
      Color bc,RGB(black)
    End If
    Print ch$;
  Next t
  Print
End Sub

Dim Monster$(30) length 24,mc(30)
Dim music$(16),epline$(5),PrizeColor(6)

ZapMusic$="932 X X X 1108 X 932 X 880 X X X 1046 X 698 X "
EyeMusic$="233 X 294 X 349 X 440 X 466 X 349 X 294 X 262 X 294 X 349 X 466 X 523 X 587 X X X "

Monster$(1)="Spider"
mc(1)=RGB(gray)
Monster$(2)="Tarantula"
mc(2)=RGB(gray)
Monster$(3)="Lizard"
mc(3)=RGB(midgreen)
Monster$(4)="Vampire Bat"
mc(4)=RGB(gray)
Monster$(5)="Snake"
mc(5)=RGB(gold)
Monster$(6)="Land Crab"
mc(6)=RGB(orange)
Monster$(7)="Smogg"
mc(7)=RGB(white)
Monster$(8)="Wild Dog"
mc(8)=RGB(lightgray)
Monster$(9)="Wolf"
mc(9)=RGB(gray)
Monster$(10)="Wight"
mc(10)=RGB(blue)
Monster$(11)="Skeleton"
mc(11)=RGB(white)
Monster$(12)="Devourer"
mc(12)=RGB(yellow)
Monster$(13)="Ghost"
mc(13)=RGB(white)
Monster$(14)="Dark Slime"
mc(14)=RGB(myrtle)
Monster$(15)="Hobgoblin"
mc(15)=RGB(myrtle)
Monster$(16)="Gremlin"
mc(16)=RGB(green)
Monster$(17)="Zombie"
mc(17)=RGB(midgreen)
Monster$(18)="Pit Fiend"
mc(18)=RGB(rust)
Monster$(19)="Dick"
mc(19)=RGB(white)
Monster$(20)="Pixie"
mc(20)=RGB(green)
Monster$(21)="Dust Devil"
mc(21)=RGB(rust)
Monster$(22)="Vampire"
mc(22)=RGB(rust)
Monster$(23)="Orc"
mc(23)=RGB(midgreen)
Monster$(24)="Troll"
mc(24)=RGB(midgreen)
Monster$(25)="Wyvern"
mc(25)=RGB(cobalt)
Monster$(26)="Arch-Devil"
mc(26)=RGB(lilac)
Monster$(27)="Shambler"
mc(27)=RGB(pink)
Monster$(28)="Hound of Tindalos"

mc(28)=RGB(cerulean)
Monster$(29)="Night-Gaunt"
mc(29)=RGB(gray)
Monster$(30)="Shoggoth"
mc(30)=RGB(green)

prizecolor(1)=RGB(beige)
prizecolor(2)=RGB(blue)
prizecolor(3)=RGB(orange)
prizecolor(4)=RGB(salmon)
prizecolor(5)=RGB(gray)
prizecolor(6)=RGB(gold)

Music$(1)="165|330 X X X 165|659 X X X 247|699 X X X 247|659 X X X 262|587 X X X X X X X 220|523 X X X 220|494 X X X 247|440 X X X X X X X 196|494 X X X 196|523 X X X 220|587 X X X X X X X 185|494 X X X X X X X "
Music$(2)="494|196 X X X X X X X 330|196 X X X 494|196 X X X 523|220 X X X 523|196 X X X 494|185 X X X 440|185 X X X 494|196 X X X X X X X 330|165 X X X X X X X 392|165 X X X X X X X 370|147 X X X X X X X "
Music$(3)="330|247 X X X 494|247 X X X 659|262 X X X 494|247 X X X 587|262 X X X 440|262 X X X 523|185 X X X 494|196 X X X 330|247 X X X 494|247 X X X 659|165 X X X 494|165 X X X 587|196 X X X 440|196 X X X 523|185 X X X 494|185 X X X "
Music$(4)="330|196 X X X 370|220 X X X 392|247 X X X 370|262 X X X 330|247 X X X X X X X 392|294 X X X 440|330 X X X 494|330 X X X X X X X 392|330 X X X 440|294 X X X 494|330 X X X X X X X 440|294 X X X X X X X "
Music$(5)="494|165 X X X 330|247 X X X 494|165 X X X 330|247 X X X 523|185 X X X 370|262 X X X 523|185 X X X 370|262 X X X "
Music$(6)="587|220 X X X 523|247 X 494|220 X 440|247 X X X 392|165 X X X 370|262 X X X 392|220 X X X 330|247 X X X X X X X "
Music$(7)="587|220 X X X 523|247 X 494|262 X 440|247 X X X 392|330 X X X 587|220 X X X 523|247 X 494|262 X 440|247 X X X 390|330 X X X "
Music$(8)="440|370 X X X X X X X 392|294 X X X X X X X 392|330 X X X X X X X 494|247 X X X X X X X "
Music$(9)="523|220 X X X X X X X X X X X X X X X 494|196 X X X X X X X X X X X X X X X 440|185 X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X "
Music$(10)="523|220 X X X 523|196 X X X 523|220 X X X X X X X 494|262 X X X X X X X 494|330 X X X X X X X 440|294 X X X X X X X X X X X X X X X X X X X X X X X X X X X "
Music$(11)="330|196 X X X 659|196 X 587|196 X 659|165 X X X 494|165 X X X 523|196 X 523|185 X 440|196 X 440|220 X 494|196 X X X 494|185 X X X "
Music$(12)="330|196 X X X X X X X X 659|220 X X X 587|220 X X X 659|165 X X X X X X X 494|124 X X X X X X X 523|131 X X X 523|147 X X X 659|165 X X X 659|185 X X X 622|196 X X X 622|220 X X X 622|247 X X X 622|262 X X X "
Music$(13)="659|247 X X X 587|247 X X X 523|247 X X X 494|247 X X X 659|247 X X X 587|247 X X X 523|247 X X X 494|247 X X X 523|165 X X X 392|165 X X X 330|165 X X X 392|165 X X X 262|165 X X X 330|165 X X X 392|165 X X X 523|165 X X X "
Music$(14)="330|196 X X X X X X X 330|220 X X X X X X X 659|196 X X X X X X X 587|185 X X X X X X X 523|196 X X X X X X X 523|262 X X X X X X X 523|294 X X X X X X X 523|220 X X X X X X X "
Music$(15)="659|330 X X X 330|165 X 699|330 X 659|350 X X X X X X X 659|330 X X X 330|165 X 699|330 X 587|294 X X X X X X X X "
Music$(16)="659|330 X X X 330|165 X 699|330 X 587|294 X X X X X X X X 659|330 X X X 330|165 X 699|330 X 659|350 X X X X X X X "
MusicCount=16

NoteLength=20
PauseLength=20
PauseIncrement=10
xmax=24
ymax=40
bc=RGB(red)
wc=RGB(orange)
Dim s(xmax,ymax)
Randomize Timer
On error ignore
Open "picomaze.grv" For input As #1
Input #1,kmaze
Input #1,aname$
Input #1,kline$
For t=1 To 5
  Line Input #1,epline$(t)
Next t
Close #1
On error abort
Do
  GameOver=0
  maze=0
  Color RGB(white),RGB(black)
  CLS
  Font 8
  Text 0,20,""
  Title$="  _______   __                       __       __"
  ShowTitle
  Title$=" |       \ |  \                     |  \     /  \"
  ShowTitle
  Title$=" | $$$$$$$\ \$$  _______   ______   | $$\   /  $$  ______   ________   ______"
  ShowTitle
  Title$=" | $$__/ $$|  \ /       \ /      \  | $$$\ /  $$$ |      \ |        \ /      \"
  ShowTitle
  Title$=" | $$    $$| $$|  $$$$$$$|  $$$$$$\ | $$$$\  $$$$  \$$$$$$\ \$$$$$$$$|  $$$$$$\"
  ShowTitle
  Title$=" | $$$$$$$ | $$| $$      | $$  | $$ | $$\$$ $$ $$ /      $$  /    $$ | $$    $$"
  ShowTitle
  Title$=" | $$      | $$| $$_____ | $$__/ $$ | $$ \$$$| $$|  $$$$$$$ /  $$$$_ | $$$$$$$$"
  ShowTitle
  Title$=" | $$      | $$ \$$     \ \$$    $$ | $$  \$ | $$ \$$    $$|  $$    \ \$$     \"
  ShowTitle
  Title$="  \$$       \$$  \$$$$$$$  \$$$$$$   \$$      \$$  \$$$$$$$ \$$$$$$$$  \$$$$$$$"
  ShowTitle
  Color RGB(white),RGB(black)
  Font 1
  Text 144,160,Chr$(38),,10,4,RGB(red)
  Box 130,120,60,100,,RGB(green)
  Line 40,90,130,120,,RGB(green)
  Line 40,260,130,220,,RGB(green)
  Line 190,120,279,90,,RGB(green)
  Line 190,220,279,260,,RGB(green)
  Text 92,260,"Press F1 for Help",,,,RGB(white)
  Text 30,272,"%$#",,9,2,RGB(yellow)
  Text 30,288," !"+Chr$(34),,9,2,RGB(brown)
  Text 78,288,"Sacred Potato Productions",,1,,RGB(white)
  Text 80,304,"Some rights reserved.",,1,,RGB(white)
  CatchKeys
  AnyKey
  If i$=Chr$(27) Then CLS :End
  If i$=Chr$(145) Then
    CLS
    ShowHelp
  End If
' Initialize player variables
  hp=10
  gp=0
  zap=1
  Story$="The "
  Select Case Int(Rnd*13)+1
    Case 1
      Story$=Story$+"Pointless "
    Case 2
      Story$=Story$+"Absurd "
    Case 3
      Story$=Story$+"Inane "
    Case 4
      Story$=Story$+"Frivolous "
    Case 5
      Story$=Story$+"Trivial "
    Case 6
      Story$=Story$+"Asinine "
    Case 7
      Story$=Story$+"Fatuous "
    Case 8
      Story$=Story$+"Negligible "
    Case 9
      Story$=Story$+"Trifling "
    Case 10
      Story$=Story$+"Aimless "
    Case 11
      Story$=Story$+"Wasted "
    Case 12
      Story$=Story$+"Futile "
    Case 13
      Story$=Story$+"Fruitless "
  End Select
  Select Case Int(Rnd*10)+1
    Case 1
      Story$=Story$+"Epic"
    Case 2
      Story$=Story$+"Tale"
    Case 3
      Story$=Story$+"Story"
    Case 4
      Story$=Story$+"Chronicle"
    Case 5
      Story$=Story$+"Saga"
    Case 6
      Story$=Story$+"Ordeal"
    Case 7
      Story$=Story$+"Narrative"
    Case 8
      Story$=Story$+"History"
    Case 9
      Story$=Story$+"Account"
    Case 10
      Story$=Story$+"Yarn"
  End Select
  Story$=Story$+" of"
  NameGen
  CLS
  Text 160-((Len(Story$)/2)*8),140,Story$
  Text 160-((Len(Pname$)/2)*8),160,PName$
  Text 50,240,"Press N to change your name"
  Text 55,260, "or any other key to start."
  CatchKeys
  anykey
  If LCase$(i$)="n" Then
    Box 0,160,320,72,,RGB(black),RGB(black)
    Text 154,160,Chr$(219)
    OName$=Pname$
    nname$=""
    v=1
    NameGen
    Do
      AnyKey
      nname$=nname$+(Mid$(Pname$,v,1))
      Text 160-(((Len(nname$)/2)+1)*8),160,NName$+Chr$(219)
      v=v+1
    Loop Until i$=Chr$(27) Or v=1+Len(pname$)
    AnyKey
    Text 0,240,String$(40,32)
    Text 160-(((Len(nname$)/2)+1)*8),160," "+NName$
    CatchKeys
    Text 55,260,"  Press any key to start.  "
    CatchKeys
    AnyKey
  End If
  i$=""
  Do
    mtitle$=""
    Select Case Int(Rnd*14)+1
      Case 1
        mtitle$="Dungeon"
      Case 2
        mtitle$="Maze"
      Case 3
        mtitle$="Mines"
      Case 4
        mtitle$="Caves"
      Case 5
        mtitle$="Keep"
      Case 6
        mtitle$="Underworld"
      Case 7
        mtitle$="Basement"
      Case 8
        mtitle$="Pits"
      Case 9
        mtitle$="AirBnB"
      Case 10
        mtitle$="Guest Bedroom"
      Case 11
        mtitle$="Castle"
      Case 12
        mtitke$="Fortress"
      Case 13
        mtitle$="Pillow Fort"
      Case 14
        mtitle$="Blanket Fort"
    End Select
    mtitle$=mtitle$+" of "
    Select Case Int(Rnd*12)+1
      Case 1
        mtitle$=mtitle$+"Narrative Convenience"
      Case 2
        mtitle$=mtitle$+"Procrastination"
      Case 4
        mtitle$=mtitle$+"Poor Game Design"
      Case 3
        mtitle$=mtitle$+"Utter Boredom"
      Case 4
        mtitle$=mtitle$+"Mystical B.S."
      Case 5
        mtitle$=mtitle$+"Tedium"
      Case 6
        mtitle$=mtitle$+"Toils & Troubles"
      Case 7
        mtitle$=mtitle$+"Wasted Potential"
      Case 8
        mtitle$=mtitle$+"Stuff"
      Case 9
        mtitle$=mtitle$+"Tonal Uncertainty"
      Case 10
        mtitle$=mtitle$+"Aimless Wandering"
      Case 11
        mtitle$=mtitle$+"Crushing Pointlessness"
      Case 12
        mtitle$=mtitle$+"Mediocre Ideas"
    End Select
    mtitle$="The "+mtitle$
  Loop Until Len(Mtitle$)<40
  mlen=20-(Len(mtitle$)/2)
  mtitle$=String$(mlen,32)+mtitle$+String$(mlen,32)+" "
  Do
    prizename$=""
    Select Case Int(Rnd*10)+1
      Case 1
        PrizeName$="Arbitrary"
      Case 2
        PrizeName$="Unnecessary"
      Case 3
        PrizeName$="Inevitable"
      Case 4
        PrizeName$="Superfluous"
      Case 5
        PrizeName$="Random"
      Case 6
        PrizeName$="Useless"
      Case 7
        PrizeName$="Frivolous"
      Case 8
        PrizeName$="Trivial"
      Case 9
        PrizeName$="Negligible"
      Case 10
        PrizeName$="Inconsequential"
    End Select
    Select Case Int(Rnd*10)+1
      Case 1
        PrizeName$=PrizeName$+" Widget"
      Case 2
        PrizeName$=PrizeName$+" Doohickey"
      Case 3
        PrizeName$=PrizeName$+" Object"
      Case 4
        PrizeName$=PrizeName$+" Thingamajig"
      Case 5
        PrizeName$=PrizeName$+" Thingamabob"
      Case 6
        PrizeName$=PrizeName$+" Whatever-It-Is"
      Case 7
        PrizeName$=PrizeName$+" Gadget"
      Case 8
        PrizeName$=PrizeName$+" Whatsit"
      Case 9
        PrizeName$=PrizeName$+" Gizmo"
      Case 10
        PrizeName$=PrizeName$+" Doodad"
      Case 11
        PrizeName$=PrizeName$+" Contrivance"
    End Select
    PrizeName$=PrizeName$+" of "
    Select Case Int(Rnd*10)+1
      Case 1
        PrizeName$=PrizeName$+"Completion"
      Case 2
        PrizeName$=PrizeName$+"Finality"
      Case 3
        PrizeName$=PrizeName$+"Victory"
      Case 4
        PrizeName$=PrizeName$+"Attainment"
      Case 5
        PrizeName$=PrizeName$+"Accomplishment"
      Case 6
        PrizeName$=PrizeName$+"Achievement"
      Case 7
        PrizeName$=PrizeName$+"Conclusion"
      Case 8
        PrizeName$=PrizeName$+"Success"
      Case 9
        PrizeName$=PrizeName$+"Acquisition"
      Case 10
        PrizeName$=PrizeName$+"Triumph"
    End Select
  Loop Until Len(PrizeName$)<40
  PrizeType=Int(Rnd*6)+1
  Do
    EyeOn=0
    zapon=0
    oldzap=0
    dead=0
    oldstufftotal=0
    For v=1 To xmax
      For j=1 To ymax
        s(v,j)=0
      Next
    Next
    If i$=Chr$(27) Then CLS :End
    maze=maze+1
    oldmessage$=""
    exitx=Int(Rnd*xmax)+1
    exity=Int(Rnd*(ymax-6))+1
    If Maze<>30 Then
      For j=exity To exity+5
        s(exitx,j)=3
      Next j
    End If
    Do
      Select Case Int(Rnd*4)+1
        Case 1
           px=1
           py=1
        Case 2
           px=xmax
           py=1
         Case 3
           px=xmax
           py=ymax
         Case 4
           px=1
           py=ymax
      End Select
    Loop Until s(px,py)<>3
    s(px,py)=2
    For t=1 To 300
      PlaceItem
      s(x,y)=1
    Next t
    If Rnd>.5 Then ' Place portals
      PlaceItem
      epx=x
      epy=y
      s(epx,epy)=4
      PlaceItem
      exx=x
      exy=y
      s(exx,exy)=5
    End If
    For t=1 To Int(Rnd*12)+1 ' Place gold pieces
      PlaceItem
      s(x,y)=6
    Next
    For t=1 To Int(Rnd*40)+20 ' Place monsters
      PlaceItem
      s(x,y)=7
    Next
    If Rnd>.5 Then ' Traps
    For t=1 To Int(Rnd*3)+1
      PlaceItem
      s(x,y)=9
    Next
    End If
    If Rnd<.8 Then ' Place key and chests
      PlaceItem
      s(x,y)=12
      For t=1 To Int(Rnd*5)+1
        PlaceItem
        s(x,y)=10
      Next
    End If
    For t=1 To Int(Rnd*3)+1 ' Hearts
      PlaceItem
      s(x,y)=8
    Next
    If Rnd>.75 Then ' Eyes
      PlaceItem
      s(x,y)=15
    End If
    If Rnd>.8 Then ' Zap
      PlaceItem
      s(x,y)=11
    End If
    If Maze=30 Then ' Prize
      PlaceItem
      PrizeX=x
      PrizeY=y
      s(x,y)=16+PrizeType
    End If
    wallchar=Int(Rnd*4)+41
    Select Case Int(Rnd*6)+1
      Case 1
        WallFC=RGB(lightgray)
        WallBG=RGB(gray)
      Case 2
        WallFC=RGB(red)
        WallBG=RGB(gray)
      Case 3
        WallFC=RGB(green)
        WallBG=RGB(brown)
      Case 4
        WallFC=RGB(beige)
        WallBG=RGB(gray)
      Case 5
        WallFC=RGB(green)
        WallBG=RGB(midgreen)
      Case 6
        WallFC=RGB(blue)
        WallBG=RGB(cobalt)
      Case 7
        WallFC=RGB(rust)
        WallBG=RGB(lightgray)
      Case 8
        WallFC=RGB(rust)
        WallBG=RGB(gray)
      Case 9
        WallFC=RGB(gray)
        WallBG=RGB(beige)
      Case 10
        WallFC=RGB(beige)
        WallBG=RGB(black)
    End Select
    If Maze=KMaze Then 'Gravestone
      PlaceItem
      s(x,y)=14
    End If
    NameGen
'Main game loop
    Color RGB(white),RGB(Black)
    CLS
    locator=1
    DrawMap
    Color RGB(white),RGB(black)
    Line 0,((xmax+1)*12)+1,ymax*8,((xmax+1)*12)+1,,WallFG
    havekey=0
    Do
      If Message$=OldMessage$ Then
        MazeLine
      End If
      If Message$<>OldMessage$ Then
        oldMessage$=Message$
        Text 0,((xmax+1)*12)+3,Message$+String$(10,32),,1,,RGB(white),RGB(black)
      End If
      Text 240,((xmax+1)*12)+3,Chr$(46),,10,,RGB(cobalt),RGB(black)
      Text 248,((xmax+1)*12)+3,Str$(eye),,1,,RGB(white),RGB(black)
      If HaveKey=1 Then
        Text 312,((xmax+1)*12)+3,Chr$(33),,10,,RGB(yellow)
      Else
        Text 312,((xmax+1)*12)+3," ",,1,,RGB(yellow)
      End If
      oldZap=Zap
      oldZapOn=ZapOn
      If zapon=1 Then
        zc=RGB(pink)
      Else
        zc=RGB(cyan)
      End If
      Text 280,((xmax+1)*12)+3,Chr$(40),,10,,zc,RGB(black)
      Text 288,((xmax+1)*12)+3,Str$(zap),,1,,RGB(white),RGB(black)
      If locator=1 Then
        If Maze=30 Then
          Line 0,(prizex*12)+5,320,(prizex*12)+5,,RGB(cyan)
          Line ((prizey-1)*8)+5,12,((prizey-1)*8)+5,299,,RGB(cyan)
        End If
        Line 0,(px*12)+4,320,(px*12)+4,,RGB(white)
        Line ((py-1)*8)+4,12,((py-1)*8)+4,299,,RGB(white)
      End If
      Text (py-1)*8,px*12,Chr$(53),,10,,RGB(yellow),RGB(black)
      If s(px,py)=3 Then
        dead=3
      End If
      Do
        oldx=px
        oldy=py
        PlayMusic
        i$=Inkey$
      Loop Until i$<>"" Or dead<>0
      If locator=1 Then
        locator=0
        Font 10
        If Maze=30 Then
          j=prizey
          For t=1 To xmax
            Text (j-1)*8,t*12,""
            DrawItem
          Next
          t=prizex
          For j=1 To ymax
            Text (j-1)*8,t*12,""
            DrawItem
          Next
        End If
        j=py
        For t=1 To xmax
          Text (j-1)*8,t*12,""
          DrawItem
        Next
        t=px
        For j=1 To ymax
          Text (j-1)*8,t*12,""
          DrawItem
        Next
        Font 1
      End If
      Select Case LCase$(i$)
        Case "e"
          If Eye>0 And EyeOn=0 Then
            eye=eye-1
            EyeOn=1
            CLS
            drawmap
            PlayQueue$=EyeMusic$
        End If
        Case " "
          If zapon=0 And zap>0 Then
            zapon=1
            playqueue$=zapmusic$
            CatchKeys
            Message$="Remove a wall, or press space to cancel."
            SaveMessage=1
          Else
            zapon=0
          End If
        Case Chr$(145)
          ShowHelp
          DrawMap
        Case Chr$(128)
          px=px-1
        Case Chr$(129)
          px=px+1
        Case Chr$(130)
          py=py-1
        Case Chr$(131)
          py=py+1
        Case Chr$(27)
          Text 0,((xmax+1)*12)+3,"Quit to title screen? y/N               ",,,,RGB(white),RGB(black)
          catchkeys
          AnyKey
          If LCase$(i$)="y" Then dead=2
        Case "L","l"
          locator=1
        Case Chr$(13)
          If s(px,py)=14 Then
            TombStone
            AnyKey
            CLS
            DrawMap
            MazeLine
          End If
      End Select
      If px>xmax Then
        If s(1,py)<>1 Then
          px=1
        Else
          hitwall=1
          px=1
        End If
      End If
      If px=0 Then
        If s(xmax,py)<>1 Then
          px=xmax
        Else
          hitwall=1
          px=xmax
        End If
      End If
      If py>ymax Then
        If s(px,1)<>1 Then
          py=1
        Else
          hitwall=1
          py=1
        End If
      End If
      If py=0 Then
        If s(px,ymax)<>1 Then
          py=ymax
        Else
          hitwall=1
          py=ymax
        End If
      End If
      If s(px,py)=1 Or hitwall=1 Then
        hitwall=0
        If zapon=1 Then
          s(px,py)=0
          zapon=0
          zap=zap-1
        Else
          dead=1
          For t=1 To 15
            If t/2=Int(t/2) Then
              wall=174
              colr=RGB(orange)
            Else
              wall=173
              colr=RGB(red)
            End If
            Text (py-1)*8,px*12,Chr$(wall),,,,RGB(cyan),RGB(black)
            Text (oldy-1)*8,oldx*12,Chr$(53),,10,,colr,RGB(black)
            Play tone(Rnd*2000)+200,(Rnd*2000)+200,50
            Pause 50
          Next t
        End If
      Else
        If dead<>2 Then
          Select Case s(px,py)
            Case 0,2,3
              'Take no action
            Case 4 ' Portal 1
              locator=1
              px=exx
              py=exy
              PlayQueue$="587 X 466 X 587 X 440 X 349 X 440 X 349 X 440 X "
            Case 5 ' Portal 2
              locator=1
              px=epx
              py=epy
              PlayQueue$="554 X 466 X 554 X 466 X 440 X 349 X 440 X 349 X "
          Case 6 ' Coins
            gp=gp+Int(Rnd*12)+1
            s(px,py)=0
            PlayQueue$="784 1568 X "
          Case 8 ' Heart
            CatchKeys
            SaveMessage=1
            lh=Int(Rnd*6)+1
            hp=hp+lh
            s(px,py)=0
            PlayQueue$="494|330 X 554|370 X 494|392 X 554|440 X 587|370 X X X X X X X "
          Case 9,13 ' Trap
            If px<>oldx Or py<>oldy Then
              lh=Int(Rnd*4)+1
              lg=Int(Rnd*8)+1
              hp=hp-lh
              gp=gp-lg
              message$="You walked into a trap! -"+Str$(lh)+" HP, -"+Str$(lg)+" GP"
              s(px,py)=13
              PlayQueue$="165 175 147|147 X X "
            End If
            SaveMessage=1
          Case 10 ' Chest
            CatchKeys
            SaveMessage=1
            If HaveKey=1 Then
              lg=Int(Rnd*12)+13
              gp=gp+lg
              lh=Int(Rnd*5)+1
              If lh<5 Then hp=hp+lh
              s(px,py)=0
              PlayQueue$="784 1568 784 1568 784 1568 X "
            Else
              px=oldx
              py=oldy
              PlayQueue$="294 311 X 294 X "
            End If
          Case 11 ' Zap
            zap=zap+1
            s(px,py)=0
            PlayQueue$="392|196 165|330 392|192 131|523 "
          Case 12 ' Key
            havekey=1
            s(px,py)=0
            PlayQueue$="1244|1244 1398|1398 "
          Case 14 ' Grave
            message$="Press enter to read the epitaph."
          Case 15 ' Eye
            PlayQueue$=EyeMusic$
            eye=eye+1
            s(px,py)=0
          Case 17,18,19,20,21,22 ' Prizes
            CatchKeys
            Color RGB(white),RGB(black)
            CLS
            Text 32,8,Chr$(45+s(px,py)),,11,8,prizecolor(s(px,py)-15),RGB(black)
            PlayQueue$="699|233 X X 587|294 X X 587|350 X X 699|233 X X 587|294 X X 587|350 X X 523|175 X X 466|220 X X 523|262 X X 587|175 X X 587|220 X X 587|262 X X 622|156 X X "
            EndGame=1
            Text 0,xmax*12,"Congratulations! You have found the",,1,,RGB(white),RGB(black)
            Text 0,(xmax+1)*12,PrizeName$+"!",,,,RGB(white),RGB(black)
            AnyKey
            Box 0,xmax*12,320,24,,RGB(black),RGB(black)
            Text 0,xmax*12,"Your quest is over. Press any key to"
            Text 0,(xmax+1)*12,"take the elevator back to the surface."
            CatchKeys
            AnyKey
            For t=0 To 160 Step 5
              Box t,0,5,400,,RGB(lightgray),RGB(lightgray)
              Box 314-t,0,5,400,,RGB(lightgray),RGB(lightgray)
              Pause 50
            Next t
            Pause 2000
            For t=160 To 0 Step -5
              Box t,0,5,400,,RGB(black),RGB(black)
              Box 314-t,0,5,400,,RGB(black),RGB(black)
              Pause 50
            Next t
            CatchKeys
            Dead=5
          Case Else ' Monster
            CatchKeys
            If s(px,py)=7 Then
              If Maze<25 Then
                mon=Int(Rnd*(maze+5))+1
              Else
                mon=Int(Rnd*30)+1
              End If
              s(px,py)=99+Mon
            Else
              Mon=s(px,py)-99
            End If
            Color RGB(white),RGB(black)
            CLS
            Text 32,8,Chr$(mon+31),,11,8,mc(mon),RGB(black)
            If Mon=19 Then
              Select Case Int(Rnd*5)+1
                Case 1
                  MonName$="Dick Haverhill"
                Case 2
                  MonName$="Dick Vanderhoof"
                Case 3
                  MonName$="Dick Waltonberg"
                Case 4
                  MonName$="Dick Cavendish"
                Case 5
                  MonName$="Dick Astor"
                Case 6
                  MonName$="Dick Vanderbilt"
                Case 7
                  MonName$="Dick Rothschild"
                Case 8
                  MonName$="Dick Mellon"
                Case 9
                  MonName$="Dick Smith-Jones"
                Case 10
                  MonName$="Dick Hearst"
              End Select
              If Rnd>.5 Then
                Select Case Int(Rnd*5)+1
                  Case 1
                    MonName$=MonName$+", Esq."
                  Case 1
                    MonName$=MonName$+", OBE"
                  Case 1
                    MonName$=MonName$+", PhD"
                  Case 1
                    MonName$=MonName$+", MD"
                  Case 1
                    MonName$=MonName$+", DDS"
                End Select
              End If
              Article$=""
            Else
              MonName$=Monster$(mon)
              If Instr("AEIOU",MonName$) Then
                Article$="An "
              Else
                Article$="A "
              End If
            End If
            Box 0,xmax*12,320,24,,RGB(black),RGB(black)
            Color RGB(white)
            Select Case Int(Rnd*2)+1
              Case 1
                Text 0,xmax*12,Article$+MonName$+" attacks!"
              Case 2
                Text 0,xmax*12,Article$+MonName$+" startles you!"
            End Select
            Print
            Print "F)ight, R)un, or N)egotiate?";
            Do
              i$=LCase$(Inkey$)
            Loop Until Instr("rfn",i$)
            Box 0,xmax*12,320,24,,RGB(black),RGB(black)
            Text 0,xmax*12,""
            Fight=0
            Select Case i$
              Case "f"
                Fight=1
              Case "r"
                If Rnd<.7 Then
                  If Len(MonName$)<18 Then
                    RunMsg$="r way."
                  Else
                    RunMsg$="."
                  End If
                  If Mon<>19 Then Print "The ";
                  Print MonName$+" blocks you"+RunMsg$
                  Fight=1
                  SuccesfulNeg=1
                  AnyKey
                Else
                  Select Case Int(Rnd*3)+1
                    Case 1
                      RunMsg$="escape"
                    Case 2
                      RunMsg$="flee"
                    Case 3
                      RunMsg$="evade"
                  End Select
                  If Mon<>19 Then RunMsg$=RunMsg$+" the"
                  Print "You "+RunMsg$+" "+MonName$+"."
                  successfulneg=1
                  AnyKey
                End If
              Case "n"
                lg=Int(Rnd*mon)+1
                If Rnd<.4 Then
                  Print "It will not negotiate with you."
                  Print "You will have to fight.";
                  AnyKey
                  successfulNeg=1
                  fight=1
                Else
                  Print "It wants "+Str$(lg)+" GP. You have "+Str$(gp)+"."
                  If lg>gp Then
                    Print "You will have to fight.";
                    Fight=1
                    AnyKey
                  Else
                    Print "Do you accept? (Y/N)";
                    Do
                      i$=LCase$(Inkey$)
                    Loop Until Instr("yn",i$)
                    Select Case i$
                      Case "y"
                        successfulneg=1
                        gp=gp-lg
                      Case "n"
                        Fight=1
                    End Select
                  End If
                End If
              End Select
              Box 0,xmax*12,320,24,,RGB(black),RGB(black)
              Text 0,xmax*12,""
              If Fight=1 Then
                successfulneg=1
                s(px,py)=0
                If Rnd<.3 Then
                  lh=0
                Else
                  lh=Int(Rnd*mon)+1
                End If
                hp=hp-lh
                Select Case Int(Rnd*5)+1
                  Case 1
                    RunMsg$="slain"
                  Case 2
                    RunMsg$="beaten"
                  Case 3
                    RunMsg$="killed"
                  Case 4
                    RunMsg$="vanquished"
                  Case 5
                    RunMsg$="defeated"
                End Select
                If hp>0 Then
                  Print "You have "+RunMsg$+" the "+MonName$+"."
                  PlayQueue$="523|262 X 440|220 X 523|196 X X X 699|175 X X X X X X X 880|131 X X X X X X X 784|165 X X X X X X X 523|131 X 440|147 X 699|175 X X X X X X X 880|175 X X X X X X X 932|262 X X X X X X X "
                Else
                  Select Case Int(Rnd*2)+1
                    Case 1
                      Print "You have died."
                    Case 2
                      Print "The "+MonName$+" killed you."
                  End Select
                End If
                If lh=0 Then
                  Print "You received no damage.";
                Else
                  Print "It did "+Str$(lh)+" HP of damage.";
                End If
                If successfulneg=1 Then
                  gameover=1
                  AnyKey
                  gameover=0
                  successfulneg=0
                End If
              End If
              CLS
              drawmap
              mazeline
            End Select
          End If
        End If
        If SaveMessage=1 Or px<>oldx Or py<>oldy Then
          Text (oldy-1)*8,oldx*12,"",,,,,RGB(black)
          t=oldx
          j=oldy
          SaveMessage=0
          Font 10
          DrawItem
          Font 1
        End If
        If gp<1 Then gp=0
        If hp<1 Then Dead=4
      Loop Until dead<>0
    Loop While dead=3
    If dead=1 Or Dead=4 Then
      If dead=1 Then
        Select Case Int(Rnd*4)+1
          Case 1
            DeathMessage$="Death by electrocution."
          Case 2
            DeathMessage$="Watch out for those walls."
          Case 3
            DeathMessage$="Avoid the walls next time."
          Case 4
            DeathMessage$="Walked right into that one, didn't you?"
        End Select
        Text 160-((Len(deathmessage$)/2)*8),160,DeathMessage$,,1,,RGB(white),RGB(black)
      End If
      Box 0,110,320,102,,RGB(black),RGB(black)
      Color RGB(white),RGB(black)
      Text 0,120,"  GAME OVER   ",,1,3,RGB(RUST),RGB(black)
      Text 0,180,"     Press E to write your epitaph",,1,,RGB(white),RGB(black)
    Text 0,192,"          or any key to quit.",,,,RGB(white),RGB(black)
    GameOver=1
    PlayQueue$="370|277 X X X X X X X X X X X X X X X 349|262 X X X X X X X 262|220 X X X X X X X 277|233 X X X X X X X 262|233 X X X X X X X 233|233 X X X X X X X "
    catchkeys
    AnyKey
    If LCase$(i$)="e" Then
      If dead=1 Then
        kline$="Killed by electrocution."
      Else
        kline$="Killed by "+Article$+MonName$
      End If
      EpDone=0
      x=1
      For t=1 To 5
        epline$(t)=""
      Next
      aname$=pname$
      TombStone
      Text 160,162,Chr$(219),,,,RGB(white)
      Do
        Text 48,280,"Press Esc when you are done.",,,,RGB(white),RGB(black)
        Do
          ox=x
          i$=Inkey$
          If Len(epline$(x))<25 And i$>Chr$(31) And i$<Chr$(128) Then
            epline$(x)=epline$(x)+i$
          Else
            If i$=Chr$(131) Or i$=Chr$(8) Then
              If Len(epline$(x))>0 Then
                epline$(x)=Left$(epline$(x),Len(epline$(x))-1)
              End If
            End If
            If i$=Chr$(128) And x>1 Then x=x-1
            If i$=Chr$(13) Or i$=Chr$(129) And x<5 Then x=x+1
          End If
          If ox<>x Then
            Text 160-(((Len(epline$(ox))+2)/2)*8),150+(12*ox)," "+epline$(ox)+" ",,,,RGB(white)
          End If
          If i$<>"" Then
            Text 160-(((Len(epline$(x))+2)/2)*8),150+(12*x)," "+epline$(x)+Chr$(219)+" ",,,,RGB(white)
         End If
        Loop Until i$=Chr$(27)
        Text 48,280,"   E)dit, S)ave, C)ancel?   ",,,,RGB(white)
        Do
          AnyKey
          i$=LCase$(i$)
        Loop Until Instr("esc"+Chr$(13)+Chr$(27),i$)
        Select Case i$
          Case Chr$(13),"s"
            Open "picomaze.grv" For output As #1
            Print #1,maze
            Print #1,aname$
            Print #1,kline$
            For t=1 To 5
              Print #1,epline$(t)
            Next t
            Close #1
            epdone=1
          Case Chr$(27),"c"
            epdone=1
        End Select
      Loop Until EpDone=1
    End If
  End If
Loop
